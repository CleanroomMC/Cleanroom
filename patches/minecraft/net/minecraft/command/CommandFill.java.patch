--- before/net/minecraft/command/CommandFill.java
+++ after/net/minecraft/command/CommandFill.java
@@ -96,7 +96,7 @@
                 NBTTagCompound nbttagcompound = new NBTTagCompound();
                 boolean flag = false;
 
-                if (args.length >= 10 && block.hasTileEntity())
+                if (args.length >= 10 && block.hasTileEntity(iblockstate))
                 {
                     String s = buildString(args, 9);
 
@@ -114,11 +114,11 @@
                 List<BlockPos> list = Lists.newArrayList();
                 i = 0;
 
-                for (int l = blockpos2.getZ(); l <= blockpos3.getZ(); l++)
+                for (int l = blockpos2.getZ(); l <= blockpos3.getZ(); ++l)
                 {
-                    for (int i1 = blockpos2.getY(); i1 <= blockpos3.getY(); i1++)
+                    for (int i1 = blockpos2.getY(); i1 <= blockpos3.getY(); ++i1)
                     {
-                        for (int j1 = blockpos2.getX(); j1 <= blockpos3.getX(); j1++)
+                        for (int j1 = blockpos2.getX(); j1 <= blockpos3.getX(); ++j1)
                         {
                             BlockPos blockpos4 = new BlockPos(j1, i1, l);
 
@@ -137,7 +137,7 @@
                                             continue;
                                         }
                                     }
-                                    else if ("replace".equals(args[8]) && !block.hasTileEntity() && args.length > 9)
+                                    else if ("replace".equals(args[8]) && !block.hasTileEntity(iblockstate) && args.length > 9)
                                     {
                                         Block block1 = CommandBase.getBlockByText(sender, args[9]);
 
@@ -178,7 +178,7 @@
                             if (world.setBlockState(blockpos4, iblockstate, 2))
                             {
                                 list.add(blockpos4);
-                                i++;
+                                ++i;
 
                                 if (flag)
                                 {
