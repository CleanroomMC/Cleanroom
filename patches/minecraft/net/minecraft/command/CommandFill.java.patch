--- before/net/minecraft/command/CommandFill.java
+++ after/net/minecraft/command/CommandFill.java
@@ -96,7 +96,7 @@
                 NBTTagCompound nbttagcompound = new NBTTagCompound();
                 boolean flag = false;
 
-                if (args.length >= 10 && block.hasTileEntity())
+                if (args.length >= 10 && block.hasTileEntity(iblockstate))
                 {
                     String s = buildString(args, 9);
 
@@ -137,7 +137,7 @@
                                             continue;
                                         }
                                     }
-                                    else if ("replace".equals(args[8]) && !block.hasTileEntity() && args.length > 9)
+                                    else if ("replace".equals(args[8]) && !block.hasTileEntity(iblockstate) && args.length > 9)
                                     {
                                         Block block1 = CommandBase.getBlockByText(sender, args[9]);
 
